import{_ as I,u as Y}from"./mRTKOK0O.js";import{e as L,f as k,g as D,o as w,h as l,i as H,r as d,j as K,k as T,c as E,a as F,b as m,n as u}from"#entry";import{u as N}from"./BkIceAGO.js";import{_ as V}from"./DlAUqK2U.js";import{h as G}from"./BLMuvzoS.js";const J={__name:"AynalisisProjectsCard",props:{title:{type:String},projects:{type:Array,required:!0},metric:{type:String,default:"effectives"}},setup(j){const a=L(),{hashColor:y}=N(),p=j,h=k(()=>(p.projects||[]).map(r=>({repoBranch:((r.repoUrl||"")?.split("/").pop().replace(".git","")||r.repoUrl)+"/"+r.branchName,...r}))),f=k(()=>{const r=[...h.value],s=p.metric;return r.sort((n,i)=>(i[s]||0)-(n[s]||0))}),g=k(()=>{const r=p.metric,s=a.t(r);return{title:{text:`${p.title}`,left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:100,right:40,top:60,bottom:30},xAxis:{type:"value",axisLabel:{formatter:"{value}"}},yAxis:{type:"category",inverse:!0,data:f.value.map(n=>n.repoBranch),axisLabel:{fontSize:8}},series:[{name:s,type:"bar",data:f.value.map(n=>n[r]),label:{show:!0,position:"right",formatter:"{c}"},itemStyle:{color:n=>y(n.name||n.data.repoUrl+"/"+n.data.branchName)},barMaxWidth:25}]}});return(r,s)=>{const n=I;return w(),D(n,{option:l(g),autoresize:""},null,8,["option"])}}},v=V(J,[["__scopeId","data-v-2007a6e7"]]),Q=H({__name:"RankingCard",props:{title:{type:String},metric:{type:String,default:"effectives"},ranking:{type:Array,default:[]}},setup(j){const a=L(),{rankColor:y}=N(),p=j,h=k(()=>p.metric),f=k(()=>a.t(h.value)),g=k(()=>{const s=[...p.ranking||[]],n=h.value;return s.sort((i,R)=>(R[n]||0)-(i[n]||0)).slice(0,10)}),r=k(()=>({title:{text:p.title,left:"center",textStyle:{fontSize:18,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:s=>{const n=s[0],i=g.value[n.dataIndex]||{};return`
          <div>
            <strong>${i.nickname}</strong><br/>
            ${a.t("commits")}: ${i.commits}<br/>
            ${a.t("additions")}: <span style="color:green">${i.additions}</span><br/>
            ${a.t("deletions")}: <span style="color:red">${i.deletions}</span><br/>
            ${a.t("effectives")}: <span style="color:teal">${i.effectives}</span>
          </div>`}},grid:{left:100,right:40,top:80,bottom:40},xAxis:{type:"value",axisLabel:{fontSize:13}},yAxis:{type:"category",inverse:!0,axisLabel:{fontSize:10},data:g.value.map(s=>s.nickname||"")},series:[{name:f.value,type:"bar",barMaxWidth:25,data:g.value.map(s=>s[h.value]||0),label:{show:!0,position:"right",formatter:"{c}"},itemStyle:{color:s=>y(s.dataIndex,g.value.length)}}]}));return(s,n)=>{const i=I;return w(),D(i,{option:l(r),autoresize:""},null,8,["option"])}}}),$=Object.assign(Q,{__name:"AynalisisRankingCard"}),X=globalThis.setInterval,Z={class:"w-full content-center"},tt={class:"max-w-[1600px] flex flex-row content-center"},et={__name:"index",setup(j){const a=Y(),y=d([]),p=d([]),h=d([]),f=d([]),g=d([]),r=d([]),s=d([]),n=d([]),i=d([]),R=d([]),S=d([]),_=d([]);function b(e){const o="YYYY-MM-DD HH:mm:ss",c=G();switch(e){case"today":return[c.startOf("day").format(o),c.endOf("day").format(o)];case"yesterday":return[c.clone().subtract(1,"day").startOf("day").format(o),c.clone().subtract(1,"day").endOf("day").format(o)];case"week":return[c.startOf("week").format(o),c.endOf("week").format(o)];case"lastWeek":return[c.clone().subtract(1,"week").startOf("week").format(o),c.clone().subtract(1,"week").endOf("week").format(o)];case"month":return[c.startOf("month").format(o),c.endOf("month").format(o)];case"lastMonth":return[c.clone().subtract(1,"month").startOf("month").format(o),c.clone().subtract(1,"month").endOf("month").format(o)];default:return[]}}const P=()=>{const[e,o]=b("today"),[c,O]=b("yesterday"),[q,B]=b("week"),[C,W]=b("lastWeek"),[x,A]=b("month"),[U,z]=b("lastMonth");a.getRepoBranches({since:e,until:o}).then(t=>{t.code===200&&(y.value=t.data)}),a.getRanking({since:e,until:o}).then(t=>{t.code===200&&(p.value=t.data)}),a.getRepoBranches({since:c,until:O}).then(t=>{t.code===200&&(h.value=t.data)}),a.getRanking({since:c,until:O}).then(t=>{t.code===200&&(f.value=t.data)}),a.getRepoBranches({since:q,until:B}).then(t=>{t.code===200&&(g.value=t.data)}),a.getRanking({since:q,until:B}).then(t=>{t.code===200&&(r.value=t.data)}),a.getRepoBranches({since:C,until:W}).then(t=>{t.code===200&&(s.value=t.data)}),a.getRanking({since:C,until:W}).then(t=>{t.code===200&&(n.value=t.data)}),a.getRepoBranches({since:x,until:A}).then(t=>{t.code===200&&(i.value=t.data)}),a.getRanking({since:x,until:A}).then(t=>{t.code===200&&(R.value=t.data)}),a.getRepoBranches({since:U,until:z}).then(t=>{t.code===200&&(S.value=t.data)}),a.getRanking({since:U,until:z}).then(t=>{t.code===200&&(_.value=t.data)})},M=d(null);return K(()=>{P(),M.value=X(()=>{P()},3e4)}),T(()=>{clearInterval(M.value)}),(e,o)=>(w(),E("div",Z,[F("div",tt,[m(v,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.todayProjects"),projects:l(y)},null,8,["class","title","projects"]),m($,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.todayRanking"),ranking:l(p)},null,8,["class","title","ranking"]),m(v,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.yesterdayProjects"),projects:l(h)},null,8,["class","title","projects"]),m($,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.yesterdayRanking"),ranking:l(f)},null,8,["class","title","ranking"]),m(v,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.weekProjects"),projects:l(g)},null,8,["class","title","projects"]),m($,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.weekRanking"),ranking:l(r)},null,8,["class","title","ranking"]),m(v,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.lastWeekProjects"),projects:l(s)},null,8,["class","title","projects"]),m($,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.lastWeekRanking"),ranking:l(n)},null,8,["class","title","ranking"]),m(v,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.monthProjects"),projects:l(i)},null,8,["class","title","projects"]),m($,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.monthRanking"),ranking:l(R)},null,8,["class","title","ranking"]),m(v,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.lastMonthProjects"),projects:l(S)},null,8,["class","title","projects"]),m($,{class:u(e.$q.screen.gt.md?"card":"card-mobile"),title:e.$t("dashboard.lastMonthRanking"),ranking:l(_)},null,8,["class","title","ranking"])])]))}},ct=V(et,[["__scopeId","data-v-7fa66a40"]]);export{ct as default};
